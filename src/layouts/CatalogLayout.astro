---
import BaseLayout from './BaseLayout.astro';
import Wrapper from '../components/Wrapper.astro';
import Space from '../components/Space.astro';
import GlobalHeader from '../components/GlobalHeader.astro';
import GlobalFooter from '../components/GlobalFooter.astro';

interface Props {
  title: string;
  description?: string;
  ogImage?: string;
  canonicalUrl?: string;
}

const { title, description, ogImage, canonicalUrl } = Astro.props;

const siteUrl = Astro.site?.toString() || 'https://ai-catalog.ru';
const fullCanonicalUrl = canonicalUrl || new URL(Astro.url.pathname, siteUrl).toString();
const fullOgImage = ogImage ? new URL(ogImage, siteUrl).toString() : `${siteUrl}/images/og-default.jpg`;
---

<BaseLayout title={`${title} | AI Catalog CIS`}>
  <Fragment slot="head">
    <meta name="description" content={description || 'Каталог AI-сервисов для ролеплея и генерации контента'} />
    <link rel="canonical" href={fullCanonicalUrl} />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description || 'Каталог AI-сервисов для ролеплея и генерации контента'} />
    <meta property="og:image" content={fullOgImage} />
    <meta property="og:url" content={fullCanonicalUrl} />
    <meta property="og:locale" content="ru_RU" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description || 'Каталог AI-сервисов для ролеплея и генерации контента'} />
    <meta name="twitter:image" content={fullOgImage} />

    <!-- Hreflang -->
    <link rel="alternate" hreflang="ru-RU" href={fullCanonicalUrl} />
    <link rel="alternate" hreflang="x-default" href={fullCanonicalUrl} />

    <!-- Pagefind -->
    <link href="/pagefind/pagefind-ui.css" rel="stylesheet" />
  </Fragment>

  <GlobalHeader slot="header" />

  <Wrapper>
    <Space size="M" />
    <slot />
    <Space size="L" />
  </Wrapper>

  <GlobalFooter slot="footer" />
</BaseLayout>
