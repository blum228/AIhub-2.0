---
import { getCollection } from 'astro:content';
import CatalogLayout from '../../layouts/CatalogLayout.astro';
import SearchWidget from '../../components/catalog/SearchWidget.astro';
import TagFilter from '../../components/catalog/TagFilter.astro';
import ToolGrid from '../../components/catalog/ToolGrid.astro';
import Space from '../../components/Space.astro';
import { sortToolsByRating, filterToolsByTags } from '../../lib/tools';
import type { ToolData } from '../../lib/types';

// –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
const toolsCollection = await getCollection('tools');

// –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ ToolData
const tools: ToolData[] = toolsCollection.map(entry => ({
  slug: entry.slug,
  ...entry.data
}));

// –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É
const sortedTools = sortToolsByRating(tools);

// –í—ã–¥–µ–ª—è–µ–º Telegram –±–æ—Ç—ã –¥–ª—è featured —Å–µ–∫—Ü–∏–∏
const telegramBots = sortedTools.filter(t => t.tags.includes('telegram-bot')).slice(0, 4);
---

<CatalogLayout
  title="–ö–∞—Ç–∞–ª–æ–≥ AI-—Å–µ—Ä–≤–∏—Å–æ–≤"
  description="–õ—É—á—à–∏–µ AI-—Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —Ä–æ–ª–µ–ø–ª–µ—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ 18+. –§–∏–ª—å—Ç—Ä—ã –ø–æ –æ–ø–ª–∞—Ç–µ, —è–∑—ã–∫—É –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏–∑ –†–æ—Å—Å–∏–∏."
>
  <!-- Hero -->
  <section class="hero">
    <h1>AI –ö–∞—Ç–∞–ª–æ–≥ –¥–ª—è –°–ù–ì</h1>
    <p class="hero__subtitle">
      –õ—É—á—à–∏–µ AI-—Å–µ—Ä–≤–∏—Å—ã –¥–ª—è —Ä–æ–ª–µ–ø–ª–µ—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.<br />
      –§–∏–ª—å—Ç—Ä—ã –ø–æ –æ–ø–ª–∞—Ç–µ –∫–∞—Ä—Ç–∞–º–∏ –†–§, –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–µ–∑ VPN.
    </p>
    <SearchWidget placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é..." />
  </section>

  <Space size="M" />

  <!-- –§–∏–ª—å—Ç—Ä—ã -->
  <TagFilter />

  <!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ç–∫–∞ -->
  <section class="tools-section">
    <h2 class="section-title">–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã</h2>
    <ToolGrid tools={sortedTools} />
  </section>

  <!-- Featured: Telegram –±–æ—Ç—ã -->
  {telegramBots.length > 0 && (
    <section class="tools-section tools-section--featured">
      <h2 class="section-title">
        <span>ü§ñ</span> Telegram –±–æ—Ç—ã
        <a href="/telegram-bots" class="section-title__link">–í—Å–µ –±–æ—Ç—ã ‚Üí</a>
      </h2>
      <ToolGrid tools={telegramBots} />
    </section>
  )}
</CatalogLayout>

<style>
  .hero {
    text-align: center;
    padding: 2em 0;
  }

  .hero h1 {
    font-size: 2.5em;
    margin-bottom: 0.3em;
  }

  .hero__subtitle {
    font-size: 1.1em;
    opacity: 0.8;
    margin-bottom: 1.5em;
    line-height: 1.5;
  }

  .tools-section {
    margin-bottom: 2em;
  }

  .tools-section--featured {
    padding: 1.5em;
    background: rgba(var(--ids__surface-RGB), 0.5);
    border-radius: var(--ids__radius);
  }

  .section-title {
    display: flex;
    align-items: center;
    gap: 0.5em;
    margin-bottom: 1em;
    font-size: 1.5em;
  }

  .section-title__link {
    margin-left: auto;
    font-size: 0.6em;
    font-weight: normal;
  }

  @media (max-width: 767px) {
    .hero h1 {
      font-size: 1.8em;
    }

    .hero__subtitle {
      font-size: 1em;
    }
  }
</style>
